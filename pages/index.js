import {formContext} from "../Utility/Context";
import {useContext, useEffect, useState} from "react";
import {motion as m} from "framer-motion";
import Head from "next/head";
import Link from "next/link";
import CareerTree from "../components/CareerTree/Tree";

export default function Home() {
	const {formData} = useContext(formContext);
	const [formSubmitted, setFormSubmitted] = useState(false);
	const [username, setUsername] = useState("");

	const capitalizeString = text => {
		if (typeof text === "string" && text.length >= 1) {
			return `${text.charAt(0).toUpperCase()}${text.substring(1)}`;
		} else return null;
	};

	useEffect(() => {
		if (Object.keys(formData).length) {
			const {firstName} = formData;
			setFormSubmitted(true);
			setUsername(firstName);
		}
	}, [formData]);

	return (
		<>
			<Head>
				<title>Oliver R. - Home</title>
				<meta name="description" content="Generated by create next app" />
				<link rel="icon" href="/favicon.ico" />
			</Head>
			<div>
				<m.h1
					initial={{x: -100, opacity: 0}}
					animate={{x: 0, opacity: 1}}
					transition={{type: "tween", ease: "easeInOut", duration: 1}}
					className="text-6xl font-light text-left"
				>
					{formSubmitted ? "What's up " : "Hi, "}
					<span className="font-medium">
						{formSubmitted ? `${capitalizeString(username)}` : "I'm Oliver"}.
					</span>
				</m.h1>
				<m.h2
					className="text-left"
					initial={{x: -100, opacity: 0}}
					animate={{x: 0, opacity: 1}}
					transition={{type: "tween", ease: "easeInOut", duration: 1, delay: 1}}
				>
					Frontend Dev{" "}
					<m.span
						className="!opacity-20"
						initial={{opacity: 0}}
						animate={{opacity: 1}}
						transition={{
							duration: 1,
							delay: 3,
						}}
					>
						(not a designer)
					</m.span>
				</m.h2>
				<CareerTree />
			</div>
		</>
	);
}
